{"@context":{"rdfs":"http://www.w3.org/2000/01/rdf-schema#","d3f":"http://d3fend.mitre.org/ontologies/d3fend.owl#","kb-article":"d3f:kb-article","definition":"d3f:definition","kb-reference":{"@id":"d3f:kb-reference","@container":"@set"}},"@graph":[{"@id":"_:b0"},{"@id":"d3f:Detect"},{"@id":"d3f:IPCTrafficAnalysis","@type":["d3f:NetworkTrafficAnalysis","http://www.w3.org/2002/07/owl#NamedIndividual","http://www.w3.org/2002/07/owl#Class"],"d3f:analyzes":{"@id":"d3f:IntranetIPCNetworkTraffic"},"d3f:d3fend-id":"IPCTA","definition":"Analyzing standard inter process communication (IPC) protocols to detect deviations from normal protocol activity.","d3f:enables":{"@id":"d3f:Detect"},"kb-article":"## How it works\nInter process communication enables applications or threads to share data. This can involve one or more computers. Monitoring IPC in your environment can reveal abnormal or malicious activity.\nIPC can occur within a single computer or between multiple computers remotely through network protocols. Thus there are multiple ways to collect and monitor these exchanges between processes. A network protocol analyzer may monitor and parse SMB network traffic to record system activity. A host based monitoring agent may monitor IPC activity contained within a single host to look for deviations from standard usages.\n\n### Examples \n * SMB\n * Zeromq\n * Java RMI API\n\n## Considerations\n* IPC can generate substantial amounts of data, and it may not be feasible to collect all of it. \n* IPC may occur over loopback interfaces or direct memory access granted by the operating system.","kb-reference":[{"@id":"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE"},{"@id":"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_"},{"@id":"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_"},{"@id":"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_"},{"@id":"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE"},{"@id":"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc"}],"d3f:synonym":"IPC Analysis","rdfs:label":"IPC Traffic Analysis","rdfs:subClassOf":[{"@id":"d3f:NetworkTrafficAnalysis"},{"@id":"_:b0"}]},{"@id":"d3f:IntranetIPCNetworkTraffic"},{"@id":"d3f:NetworkTrafficAnalysis"},{"@id":"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_"},{"@id":"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_"},{"@id":"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_"},{"@id":"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE"},{"@id":"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE"},{"@id":"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc"}],"_:b0":{"@id":"_:b0"},"d3f:Detect":{"@id":"d3f:Detect"},"d3f:IPCTrafficAnalysis":{"@id":"d3f:IPCTrafficAnalysis","@type":["d3f:NetworkTrafficAnalysis","http://www.w3.org/2002/07/owl#NamedIndividual","http://www.w3.org/2002/07/owl#Class"],"d3f:analyzes":{"@id":"d3f:IntranetIPCNetworkTraffic"},"d3f:d3fend-id":"IPCTA","definition":"Analyzing standard inter process communication (IPC) protocols to detect deviations from normal protocol activity.","d3f:enables":{"@id":"d3f:Detect"},"kb-article":"## How it works\nInter process communication enables applications or threads to share data. This can involve one or more computers. Monitoring IPC in your environment can reveal abnormal or malicious activity.\nIPC can occur within a single computer or between multiple computers remotely through network protocols. Thus there are multiple ways to collect and monitor these exchanges between processes. A network protocol analyzer may monitor and parse SMB network traffic to record system activity. A host based monitoring agent may monitor IPC activity contained within a single host to look for deviations from standard usages.\n\n### Examples \n * SMB\n * Zeromq\n * Java RMI API\n\n## Considerations\n* IPC can generate substantial amounts of data, and it may not be feasible to collect all of it. \n* IPC may occur over loopback interfaces or direct memory access granted by the operating system.","kb-reference":[{"@id":"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE"},{"@id":"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_"},{"@id":"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_"},{"@id":"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_"},{"@id":"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE"},{"@id":"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc"}],"d3f:synonym":"IPC Analysis","rdfs:label":"IPC Traffic Analysis","rdfs:subClassOf":[{"@id":"d3f:NetworkTrafficAnalysis"},{"@id":"_:b0"}]},"d3f:IntranetIPCNetworkTraffic":{"@id":"d3f:IntranetIPCNetworkTraffic"},"d3f:NetworkTrafficAnalysis":{"@id":"d3f:NetworkTrafficAnalysis"},"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_":{"@id":"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_"},"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_":{"@id":"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_"},"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_":{"@id":"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_"},"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE":{"@id":"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE"},"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE":{"@id":"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE"},"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc":{"@id":"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc"},"name":"d3f:IPCTrafficAnalysis","related_offensive_matrix":{"Defense Evasion":[["BITS Jobs",[{"otech_parent_string":{"type":"literal","value":"Defense Evasion Technique"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"true"},"otech_string":{"type":"literal","value":"BITS Jobs"},"otech_id":{"type":"literal","value":"T1197"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DefenseEvasion"},"otactic_string":{"type":"literal","value":"Defense Evasion"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1197"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#may-produce"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Detect"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}},{"otech_parent_string":{"type":"literal","value":"Persistence Technique"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"true"},"otech_string":{"type":"literal","value":"BITS Jobs"},"otech_id":{"type":"literal","value":"T1197"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DefenseEvasion"},"otactic_string":{"type":"literal","value":"Defense Evasion"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1197"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#may-produce"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Detect"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}}]]],"Persistence":[["BITS Jobs",[{"otech_parent_string":{"type":"literal","value":"Defense Evasion Technique"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"true"},"otech_string":{"type":"literal","value":"BITS Jobs"},"otech_id":{"type":"literal","value":"T1197"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Persistence"},"otactic_string":{"type":"literal","value":"Persistence"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1197"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#may-produce"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Detect"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}},{"otech_parent_string":{"type":"literal","value":"Persistence Technique"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"true"},"otech_string":{"type":"literal","value":"BITS Jobs"},"otech_id":{"type":"literal","value":"T1197"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Persistence"},"otactic_string":{"type":"literal","value":"Persistence"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1197"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#may-produce"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"Intranet IPC Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Detect"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}}]]]},"digital_artifacts":{"head":{"vars":["relationship","relationship_label","relationship_comment","digital_artifact","digital_artifact_label","digital_artifact_comment"]},"results":{"bindings":[{"relationship":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#analyzes"},"relationship_label":{"type":"literal","value":"analyzes"},"relationship_comment":{"type":"literal","value":"x analyzes y: The subject x break down object y into components or essential features, assessing y by quantitative methods, qualitative methods, or both.  Usually the analysis is done in terms of some model or framework."},"digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#IntranetIPCNetworkTraffic"},"digital_artifact_label":{"type":"literal","value":"Intranet IPC Network Traffic"},"digital_artifact_comment":{"type":"literal","value":"Intranet IPC network traffic is network traffic that does not cross a given network's boundaries and uses a standard inter-process communication (IPC) networking protocol."}}]}},"references":{"@context":{"rdfs":"http://www.w3.org/2000/01/rdf-schema#","d3f":"http://d3fend.mitre.org/ontologies/d3fend.owl#"},"@graph":[{"@id":"d3f:Reference_CAR-2013-01-003:SMBEventsMonitoring_","@type":["d3f:ExternalKnowledgeBase","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://car.mitre.org/analytics/CAR-2013-01-003/"},"d3f:kb-abstract":"Server Message Block (SMB) is used by Windows to allow for file, pipe, and printer sharing over port 445/tcp. It allows for enumerating, and reading from and writing to file shares for a remote computer. Although it is heavily used by Windows servers for legitimate purposes and by users for file and printer sharing, many adversaries also use SMB to achieve Lateral Movement. Looking at this activity more closely to obtain an adequate sense of situational awareness may make it possible to detect adversaries moving between hosts in a way that deviates from normal activity. Because SMB traffic is heavy in many environments, this analytic may be difficult to turn into something that can be used to quickly detect an APT. In some cases, it may make more sense to run this analytic in a forensic fashion. Looking through and filtering its output after an intrusion has been discovered may be helpful in identifying the scope of compromise.\n\nOutput Description:\nThe source, destination, content, and time of each event.","d3f:kb-author":"MITRE","d3f:kb-is-example-of":{"@id":"d3f:IPCTrafficAnalysis"},"d3f:kb-mitre-analysis":"","d3f:kb-organization":"MITRE","d3f:kb-reference-title":"CAR-2013-01-003: SMB Events Monitoring","d3f:reference-type-label":"External Knowledge Base","rdfs:label":"Reference - CAR-2013-01-003: SMB Events Monitoring -"},{"@id":"d3f:Reference_CAR-2013-05-003:SMBWriteRequest_","@type":["d3f:ExternalKnowledgeBase","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://car.mitre.org/analytics/CAR-2013-05-003/"},"d3f:kb-abstract":"As described in CAR-2013-01-003, SMB provides a means of remotely managing a file system. Adversaries often use SMB to move laterally to a host. SMB is commonly used to upload files. It may be used for staging in Exfiltration or as a Lateral Movement technique. Unlike SMB Reads, SMB Write requests typically require an additional level of access, resulting in less activity. Focusing on SMB Write activity narrows the field to find techniques that actively change remote hosts, instead of passively reading files.","d3f:kb-author":"","d3f:kb-is-example-of":{"@id":"d3f:IPCTrafficAnalysis"},"d3f:kb-mitre-analysis":"","d3f:kb-organization":"","d3f:kb-reference-title":"CAR-2013-05-003: SMB Write Request","d3f:reference-type-label":"External Knowledge Base","rdfs:label":"Reference - CAR-2013-05-003: SMB Write Request -"},{"@id":"d3f:Reference_CAR-2013-05-005:SMBCopyAndExecution_","@type":["d3f:ExternalKnowledgeBase","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://car.mitre.org/analytics/CAR-2013-05-005/"},"d3f:kb-abstract":"An adversary needs to gain access to other hosts to move throughout an environment. In many cases, this is a twofold process. First, a file is remotely written to a host via an SMB share (detected by CAR-2013-05-003). Then, a variety of Execution techniques can be used to remotely establish execution of the file or script. To detect this behavior, look for files that are written to a host over SMB and then later run directly as a process or in the command line arguments. SMB File Writes and Remote Execution may happen normally in an environment, but the combination of the two behaviors is less frequent and more likely to indicate adversarial activity.\n\nThis can possibly extend to more copy protocols in order to widen its reach, or it could be tuned more finely to focus on specific program run locations (e.g. %SYSTEMROOT%\\system32) to gain a higher detection rate.","d3f:kb-author":"","d3f:kb-is-example-of":[{"@id":"d3f:IPCTrafficAnalysis"},{"@id":"d3f:ProcessSpawnAnalysis"}],"d3f:kb-mitre-analysis":"","d3f:kb-organization":"","d3f:kb-reference-title":"CAR-2013-05-005: SMB Copy and Execution","d3f:reference-type-label":"External Knowledge Base","rdfs:label":"Reference - CAR-2013-05-005: SMB Copy and Execution -"},{"@id":"d3f:Reference_CAR-2013-09-003:SMBSessionSetups_MITRE","@type":["d3f:ExternalKnowledgeBase","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://car.mitre.org/analytics/CAR-2013-09-003/"},"d3f:kb-abstract":"Account usage within SMB can be used to identify compromised credentials, and the hosts accessed with them.\n\nThis analytic monitors SMB activity that deals with user activity rather than file activity.","d3f:kb-author":"MITRE","d3f:kb-is-example-of":[{"@id":"d3f:AuthorizationEventThresholding"},{"@id":"d3f:IPCTrafficAnalysis"}],"d3f:kb-mitre-analysis":"","d3f:kb-organization":"MITRE","d3f:kb-reference-title":"CAR-2013-09-003: SMB Session Setups","d3f:reference-type-label":"External Knowledge Base","rdfs:label":"Reference - CAR-2013-09-003: SMB Session Setups - MITRE"},{"@id":"d3f:Reference_CAR-2014-03-001:SMBWriteRequest-NamedPipes_MITRE","@type":["d3f:ExternalKnowledgeBase","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://car.mitre.org/analytics/CAR-2014-03-001/"},"d3f:kb-abstract":"An SMB write can be an indicator of lateral movement, especially when combined with other information such as execution of that written file. Named pipes are a subset of SMB write requests. Named pipes such as msftewds may not be alarming; however others, such as lsarpc, may.\n\nMonitoring SMB write requests still creates some noise, particularly with named pipes. As a result, SMB is now split between writing named pipes and writing other files.","d3f:kb-author":"MITRE","d3f:kb-is-example-of":[{"@id":"d3f:IPCTrafficAnalysis"},{"@id":"d3f:RPCTrafficAnalysis"}],"d3f:kb-mitre-analysis":"","d3f:kb-organization":"MITRE","d3f:kb-reference-title":"CAR-2014-03-001: SMB Write Request - NamedPipes","d3f:reference-type-label":"External Knowledge Base","rdfs:label":"Reference - CAR-2014-03-001: SMB Write Request - NamedPipes - MITRE"},{"@id":"d3f:Reference_SecuritySystemWithMethodologyForInterprocessCommunicationControl_CheckPointSoftwareTechInc","@type":["d3f:PatentReference","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://patents.google.com/patent/US20040199763"},"d3f:kb-abstract":"A security system with methodology for interprocess communication control is described. In one embodiment, a method for controlling interprocess communication is provided that includes steps of: defining rules indicating which system services a given application can invoke; trapping an attempt by a particular application to invoke a particular system service; identifying the particular application that is attempting to invoke the particular system service; and based on identity of the particular application and on the rules indicating which system services a given application can invoke, blocking the attempt when the rules indicate that the particular application cannot invoke the particular system service.","d3f:kb-author":"Gregor Freund","d3f:kb-is-example-of":{"@id":"d3f:IPCTrafficAnalysis"},"d3f:kb-mitre-analysis":"This patent describes a technique for monitoring interprocess communications to prevent malicious applications from requesting system services. API calls are monitored to detect malicious applications attempting to open a communication channel (port) to access system services or sending messages to other applications using user32 API functions. These requests are examined against an external rules engine or whitelist, matches deny or block access and produce an error message such as connection refused or service not available.","d3f:kb-organization":"Check Point Software Tech Inc","d3f:kb-reference-title":"Security System with Methodology for Interprocess Communication Control","d3f:reference-type-label":"Patent","rdfs:label":"Reference - Security System with Methodology for Interprocess Communication Control - Check Point Software Tech Inc"}]},"references_meta":{"External Knowledge Base":5,"Patent":1}}