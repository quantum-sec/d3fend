{"@context":{"rdfs":"http://www.w3.org/2000/01/rdf-schema#","d3f":"http://d3fend.mitre.org/ontologies/d3fend.owl#","kb-article":"d3f:kb-article","definition":"d3f:definition","kb-reference":{"@id":"d3f:kb-reference","@container":"@set"}},"@graph":[{"@id":"_:b0"},{"@id":"d3f:DNSDenylisting"},{"@id":"d3f:DNSNetworkTraffic"},{"@id":"d3f:ForwardResolutionIPDenylisting","@type":["http://www.w3.org/2002/07/owl#NamedIndividual","d3f:DNSDenylisting","http://www.w3.org/2002/07/owl#Class"],"d3f:blocks":[{"@id":"d3f:DNSNetworkTraffic"},{"@id":"d3f:InboundInternetDNSResponseTraffic"}],"d3f:d3fend-id":"D3-FRIDL","definition":"Blocking a DNS lookup's answer's IP address value.","d3f:enables":{"@id":"d3f:Isolate"},"kb-article":"## How it works\n\nThis technique prevents a client from learning IP addresses deemed to be potentially malicious, which would have been delivered via forward resolution responses.\n\nResponses to forward resolution requests (that is, requests where a domain is sent and IP(s) are returned) are collected, and the IP address(es) included as a response are examined. If the IP address(es) are in a range included in the blacklist, then the response is dropped and not forwarded to the client.\n\nThe DNS lookup can be blocked by either dropping the network traffic with an inline device, or modifying the value of the response sent by the DNS server. To transparently prevent client applications from hanging on a request, it is common practice to replace malicious values with addresses in the range 127.0.0.0/8 or the address of a honeypot maintained by the network administrators.\n\n## Considerations\n\n* This technique does not prevent the client from contacting the blacklisted IP, only from learning about this IP address via a nameserver lookup request.\n* DNS Response traffic can be transmitted over many different protocols, which presents a challenge to implementing methods to extract all DNS answer IP address value(s).\n  * DNS has historically used UDP port 53, with TCP port 53 instead used for responses over 512 bytes or after a lack of response over UDP.\n  * Usage of new protocols to provide confidentiality for DNS traffic, such as DoH (DNS over HTTPS) and DoT (DNS over TLS), complicates collection of the IP address(es) in DNS responses. These protocols have often been enabled in browser settings transparently after a browser update, with DNS requests proxied over one of these cryptographic protocols through a specified host.\n* This technique must be implemented logically between the application that receives the response and the server which sent the response.\n  * DNS responses sent in an encrypted manner, such as those using DoH or DoT, will require interception of the TLS connections in order to determine the IP address(es) in the response.\n* Replacing the response is not effective in the case that the nameserver uses a technique to provide integrity of its responses, such as DNSSEC for DNS responses.","kb-reference":[{"@id":"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries"}],"d3f:synonym":"Forward Resolution IP Blacklisting","rdfs:label":"Forward Resolution IP Denylisting","rdfs:subClassOf":[{"@id":"d3f:DNSDenylisting"},{"@id":"_:b0"}]},{"@id":"d3f:InboundInternetDNSResponseTraffic"},{"@id":"d3f:Isolate"},{"@id":"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries"}],"_:b0":{"@id":"_:b0"},"d3f:DNSDenylisting":{"@id":"d3f:DNSDenylisting"},"d3f:DNSNetworkTraffic":{"@id":"d3f:DNSNetworkTraffic"},"d3f:ForwardResolutionIPDenylisting":{"@id":"d3f:ForwardResolutionIPDenylisting","@type":["http://www.w3.org/2002/07/owl#NamedIndividual","d3f:DNSDenylisting","http://www.w3.org/2002/07/owl#Class"],"d3f:blocks":[{"@id":"d3f:DNSNetworkTraffic"},{"@id":"d3f:InboundInternetDNSResponseTraffic"}],"d3f:d3fend-id":"D3-FRIDL","definition":"Blocking a DNS lookup's answer's IP address value.","d3f:enables":{"@id":"d3f:Isolate"},"kb-article":"## How it works\n\nThis technique prevents a client from learning IP addresses deemed to be potentially malicious, which would have been delivered via forward resolution responses.\n\nResponses to forward resolution requests (that is, requests where a domain is sent and IP(s) are returned) are collected, and the IP address(es) included as a response are examined. If the IP address(es) are in a range included in the blacklist, then the response is dropped and not forwarded to the client.\n\nThe DNS lookup can be blocked by either dropping the network traffic with an inline device, or modifying the value of the response sent by the DNS server. To transparently prevent client applications from hanging on a request, it is common practice to replace malicious values with addresses in the range 127.0.0.0/8 or the address of a honeypot maintained by the network administrators.\n\n## Considerations\n\n* This technique does not prevent the client from contacting the blacklisted IP, only from learning about this IP address via a nameserver lookup request.\n* DNS Response traffic can be transmitted over many different protocols, which presents a challenge to implementing methods to extract all DNS answer IP address value(s).\n  * DNS has historically used UDP port 53, with TCP port 53 instead used for responses over 512 bytes or after a lack of response over UDP.\n  * Usage of new protocols to provide confidentiality for DNS traffic, such as DoH (DNS over HTTPS) and DoT (DNS over TLS), complicates collection of the IP address(es) in DNS responses. These protocols have often been enabled in browser settings transparently after a browser update, with DNS requests proxied over one of these cryptographic protocols through a specified host.\n* This technique must be implemented logically between the application that receives the response and the server which sent the response.\n  * DNS responses sent in an encrypted manner, such as those using DoH or DoT, will require interception of the TLS connections in order to determine the IP address(es) in the response.\n* Replacing the response is not effective in the case that the nameserver uses a technique to provide integrity of its responses, such as DNSSEC for DNS responses.","kb-reference":[{"@id":"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries"}],"d3f:synonym":"Forward Resolution IP Blacklisting","rdfs:label":"Forward Resolution IP Denylisting","rdfs:subClassOf":[{"@id":"d3f:DNSDenylisting"},{"@id":"_:b0"}]},"d3f:InboundInternetDNSResponseTraffic":{"@id":"d3f:InboundInternetDNSResponseTraffic"},"d3f:Isolate":{"@id":"d3f:Isolate"},"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries":{"@id":"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries"},"name":"d3f:ForwardResolutionIPDenylisting","related_offensive_matrix":{"Command And Control":[["Application Layer Protocol",[{"otech_parent_string":{"type":"literal","value":"Application Layer Protocol"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"false"},"otech_string":{"type":"literal","value":"DNS"},"otech_id":{"type":"literal","value":"T1071.004"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#CommandAndControl"},"otactic_string":{"type":"literal","value":"Command And Control"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1071.004"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#produces"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#OutboundInternetDNSLookupTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Outbound Internet DNS Lookup Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"DNS Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Isolate"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}}]],["Dynamic Resolution",[{"otech_parent_string":{"type":"literal","value":"Command and Control Technique"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"true"},"otech_string":{"type":"literal","value":"Dynamic Resolution"},"otech_id":{"type":"literal","value":"T1568"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#CommandAndControl"},"otactic_string":{"type":"literal","value":"Command And Control"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1568"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#produces"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#OutboundInternetDNSLookupTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Outbound Internet DNS Lookup Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"DNS Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Isolate"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}},{"otech_parent_string":{"type":"literal","value":"Dynamic Resolution"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"false"},"otech_string":{"type":"literal","value":"Fast Flux DNS"},"otech_id":{"type":"literal","value":"T1568.001"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#CommandAndControl"},"otactic_string":{"type":"literal","value":"Command And Control"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1568.001"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#produces"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#OutboundInternetDNSLookupTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Outbound Internet DNS Lookup Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"DNS Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Isolate"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}},{"otech_parent_string":{"type":"literal","value":"Dynamic Resolution"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"false"},"otech_string":{"type":"literal","value":"Domain Generation Algorithms"},"otech_id":{"type":"literal","value":"T1568.002"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#CommandAndControl"},"otactic_string":{"type":"literal","value":"Command And Control"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1568.002"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#produces"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#OutboundInternetDNSLookupTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Outbound Internet DNS Lookup Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"DNS Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Isolate"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}},{"otech_parent_string":{"type":"literal","value":"Dynamic Resolution"},"otech_parent_is_toplevel":{"datatype":"http://www.w3.org/2001/XMLSchema#boolean","type":"literal","value":"false"},"otech_string":{"type":"literal","value":"DNS Calculation"},"otech_id":{"type":"literal","value":"T1568.003"},"offensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#CommandAndControl"},"otactic_string":{"type":"literal","value":"Command And Control"},"offensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"},"offensive_technique":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#T1568.003"},"offensive_artifact_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#produces"},"o_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#OutboundInternetDNSLookupTraffic"},"o_digital_artifact_string":{"type":"literal","value":"Outbound Internet DNS Lookup Traffic"},"d_digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"d_digital_artifact_string":{"type":"literal","value":"DNS Network Traffic"},"defensive_tactic":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#Isolate"},"defensive_verb":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#enables"}}]]]},"digital_artifacts":{"head":{"vars":["relationship","relationship_label","relationship_comment","digital_artifact","digital_artifact_label","digital_artifact_comment"]},"results":{"bindings":[{"relationship":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#blocks"},"relationship_label":{"type":"literal","value":"blocks"},"relationship_comment":{"type":"literal","value":"x blocks y: The entity x blocks off the use of digital artifact y by reference to a block or allow list (or both.)"},"digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#DNSNetworkTraffic"},"digital_artifact_label":{"type":"literal","value":"DNS Network Traffic"},"digital_artifact_comment":{"type":"literal","value":"RPC network traffic is network traffic related to remote procedure calls between network nodes..This includes only network traffic conforming to a standard RPC protocol; not custom protocols."}},{"relationship":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#blocks"},"relationship_label":{"type":"literal","value":"blocks"},"relationship_comment":{"type":"literal","value":"x blocks y: The entity x blocks off the use of digital artifact y by reference to a block or allow list (or both.)"},"digital_artifact":{"type":"uri","value":"http://d3fend.mitre.org/ontologies/d3fend.owl#InboundInternetDNSResponseTraffic"},"digital_artifact_label":{"type":"literal","value":"Inbound Internet DNS Response Traffic"},"digital_artifact_comment":{"type":"literal","value":"Inbound internet DNS response traffic is DNS response traffic from a host outside a given network initiated on an incoming connection to a host inside that network."}}]}},"references":{"@context":{"rdfs":"http://www.w3.org/2000/01/rdf-schema#","d3f":"http://d3fend.mitre.org/ontologies/d3fend.owl#"},"@graph":[{"@id":"d3f:Reference-UseDNSPolicyForApplyingFiltersOnDNSQueries","@type":["d3f:UserManualReference","http://www.w3.org/2002/07/owl#NamedIndividual"],"d3f:has-link":{"@type":"http://www.w3.org/2001/XMLSchema#anyURI","@value":"https://docs.microsoft.com/en-us/windows-server/networking/dns/deploy/apply-filters-on-dns-queries"},"d3f:kb-organization":"Microsoft","d3f:kb-reference-title":"Use DNS Policy for Applying Filters on DNS Queries","d3f:reference-type-label":"User Manual","rdfs:label":"Reference - Use DNS Policy for Applying Filters on DNS Queries"}]},"references_meta":{"User Manual":1}}